<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cryptography, Linux, and You</title>
<link rel="icon" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAIAAAACAAQAAAADrRVxmAAAACXBIWXMAAAMfAAADHwHmEQywAAAAGXRFWHRTb2Z0d2FyZQB3d3cuaW5rc2NhcGUub3Jnm+48GgAAAVZJREFUSMfd1EuOwyAMAFAQ0rAZNUfIUTga5GbsZtkrcINhyQLBYMgHG6ZddJcoSpOXDzY2ZZls7F5Q9iAzhyu/XsAomCm4AdRHYPUUNAH7GTgdRbZd+k6FCZgGZQPw/DV45dgIWw+rc3rrRvGrHcBrjmDzqocAIBCIsr+ERcYFwYNAfMj0QPC9pC+JIWNgpfJvQGXTQwJYCFgMegSHIWPIA/DaplO49UIuEy7qUR5gWakJHA+oXZhNZYBYQNQnlgaBKSthrRjRwJXfcu+ZA28A5fmF7yXWwKg+BgB9AJyxPtgGib8FQSCKjEcZQR7XqUUaTgiCgJME9vRPMEwREJk+McCKodUBDUvjiDTSfU4v2NPvwCqc7QHif3Bz6Ga9vZIYga5yVs9rO1Qf+uOnSw6yhnKu2Yurx+C/Ru8TVLuQl9HPtmx9CqCvTlYwxxz3eqhv3Htl/wEokJpySHNGkgAAAABJRU5ErkJggg==">
<style>
@media (prefers-color-scheme:dark) {body {background-color:#000;color:#FFF;}
a:visited {color:#C0F;}
a:link, a:hover, a:active {color:#0CF;}
}
@media print {body {max-width:8in;font-size:12px;margin:0;}
}
@media screen {body {font-family:sans-serif;max-width:35em;margin:22px auto 64px auto;padding:0 8px;}
}
body {overflow-wrap:break-word;}
@page {size:auto;margin:0.25in 0.5in 0.5in 0.5in;}
svg {fill:currentColor;}
img {max-width:100%;height:auto;}
hr {border-style:solid none;}
.content {margin:1em 0;}
.content hr {padding:0;margin:0;border:none;text-align:center;}
.content hr:after {font-size:150%;content:"* \A0 * \A0 *";display:block;position:relative;}
.rightside {text-align:right;}
.centered {text-align:center;}
pre {overflow-x:auto;}
.byline > * {display:inline-block;border-style:solid;border-width:thin;padding:3px 8px;border-radius:5px;text-align:initial;}
.byline {text-align:right;}
.box {border-style:solid;border-width:thin;margin:8px 0;padding:0 8px;}
a.hiddenlink:link {background:inherit;color:inherit;text-decoration:none;}
a.hiddenlink:visited {background:inherit;color:inherit;text-decoration:none;}
a.hiddenlink:active {background:inherit;color:inherit;text-decoration:none;}
ul,ol {padding-left:30px;}
table.border {border-collapse:collapse;margin:8px auto;}
table.border tr > * {border-style:solid;border-width:thin;padding:3px 8px;border-radius:5px;}
.tophead {text-align:center;margin:1ex auto 0 auto;max-width:35em;}
.tightmargins li > ul > li {list-style-type:square;}
.tightmargins h1,
.tightmargins h2,
.tightmargins p,
.tightmargins ul {margin:0.5ex 0;}
.tightmargins li > ul {margin:0 0 0.5ex 0;}
.tightmargins ul {padding-left:30px;}
.tightmargins li {margin:0 0 0.5ex 0;}
.plainlink a:link,
.plainlink a:visited,
.plainlink a:hover,
.plainlink a:active {color:inherit;text-decoration:underline;}
.nolink a:link,
.nolink a:visited,
.nolink a:hover,
.nolink a:active {color:inherit;text-decoration:none;}
div.lcr {display:grid;grid-template-columns:auto auto auto;}
ul.flat {list-style-type:none;margin:16px 0;padding:0;}
ul.flat li {display:inline;}
ul.flat li::after {content:"]";}
ul.flat li::before {content:"[";}
</style>
<link rel="alternate" type="application/atom+xml" title="/vv/" href="/vv/rss.rss">
<!-- Copyright 1997-2022 Hal Canary. ALL RIGHTS RESERVED. -->
</head>
<body>
<div class="tophead" role="banner">
<svg aria-label="Hal W Canary 3" role="img" viewBox="-200 0 800 91" width="100%">
<title>Hal W Canary 3</title>
<rect height="4" width="180" x="-200" y="43" />
<rect height="4" width="180" x="420" y="43" />
<path d="M 34 0 C 30 6 28 13 27 20 C 26 23 27 28 25 31 C 21 35 13 34 9 35 C 12
24 9 13 12 3 L 8 2 C 4 18 6 36 3 53 C 2 58 -1 66 5 70 C 6 59 8 49 9 39 C 14 39
19 38 25 38 C 25 49 23 61 23 73 C 30 70 27 60 27 54 C 28 36 31 17 38 1 L 34 0" />
<path d="M 50 31 C 46 38 44 45 41 53 C 40 56 39 60 40 64 L 42 64 C 44 59 45 54
46 49 C 48 50 49 51 52 52 C 50 57 52 63 57 66 C 58 61 56 56 56 51 C 59 50 61 49
64 47 C 61 46 58 46 56 45 C 53 42 53 34 52 31 L 50 31 z M 49 41 C 50 43 50 44
51 47 L 47 49 C 47 46 48 43 49 41 z" />
<path d="M 83 61 C 79 59 74 60 71 57 C 68 53 70 41 71 37 C 64 39 66 46 65 52 C
65 54 64 58 66 60 C 70 65 79 65 83 61" />
<path d="M 107 13 C 104 23 104 36 108 47 C 111 54 114 63 121 54 C 122 52 123
51 124 50 C 125 51 127 53 129 54 C 134 57 139 55 143 50 C 149 43 153 34 157 26
C 159 21 162 17 163 13 L 158 13 C 154 23 149 34 142 43 C 141 46 138 48 137 52 C
132 50 129 48 127 44 L 125 45 C 124 43 124 43 123 43 C 121 46 118 49 116 53 C
114 48 112 45 111 41 C 109 31 109 22 110 13 L 107 13" />
<path d="M 153 53 L 152 56 C 154 56 155 56 158 56 C 156 54 155 53 153 53" />
<path d="M 211 55 C 206 56 203 58 199 57 C 189 57 180 46 182 36 C 183 27 190
18 198 13 C 205 9 210 11 218 12 C 213 3 204 5 198 8 C 188 14 175 29 177 42 C
178 51 187 60 196 62 C 201 63 212 63 211 55" />
<path d="M 230.2793 37.738281 C 229.89349 37.729675 229.46875 37.8125 229 38 C
226 39 224 42 223 45 C 220 50 218 57 220 64 C 223 61 223 58 224 54 C 232 54 231
62 235 69 C 239 64 232 56 241 54 C 239 51 238 50 235 50 C 234.09375 46.375
234.00873 37.821472 230.2793 37.738281 z M 228 44 C 229 45 230 47 231 50 L 226
50 L 228 44 z" />
<path d="M 245 42 C 243 47 242 54 243 59 C 243 61 243 65 245 65 C 249 64 246
52 247 50 C 252 55 253 73 263 72 C 261 66 261 61 260 56 C 263 53 263 47 263 43
C 259 46 257 52 257 58 C 254 51 252 44 245 42" />
<path d="M 286 43 C 273 43 274 64 274 74 C 283 72 274 61 284 60 L 285 74 L 290
74 C 289 68 286 61 293 59 L 293 56 C 286 54 286 48 286 43 z M 282 49 C 283 51
283 53 284 56 L 279 57 C 279 54 280 51 282 49 z" />
<path d="M 304.79297 41.806641 C 301.8125 41.765625 297.875 44.5 297 48 C 295
54 295 64 297 71 C 300 68 300 66 301 62 C 303 65 306 70 310 73 C 315 76 316 69
316 66 C 310 67 308 63 305 59 C 307 58 310 58 312 55 C 315 51 312 44 306 42 C
305.625 41.875 305.21875 41.8125 304.79297 41.806641 z M 304.15039 47.570312 C
306.09 47.667908 308.375 49.34375 310 53 L 301 56 C 299.21875 50.65625
301.31558 47.427673 304.15039 47.570312 z" />
<path d="M 329 90 C 330 89 332 89 333 87 C 334 85 331 80 331 77 C 330 71 333
65 332 60 C 337 56 342 50 341 44 C 337 45 333 53 330 53 C 325 53 326 47 325 45
C 325 43 324 42 322 43 C 319 45 322 52 323 54 C 324 58 327 59 328 63 C 329 67
327 71 327 74 C 326 80 327 84 329 90" />
<path d="M 372 10 L 374 13 C 376 12 377 12 380 13 C 381 13 382 14 383 14 C 384
15 386 15 386 16 C 394 24 373 25 375 34 C 377 40 390 43 389 51 C 387 59 375 62
375 71 C 383 67 399 55 393 45 C 390 38 382 37 380 31 C 384 29 394 26 395 20 C
395 17 392 15 389 13 C 384 9 378 6 372 10" />
</svg>
</div>
<div role="main">
<h1>Cryptography, Linux, and You</h1>
<p>Hal Canary</p>
<p>Talk given at <a href="http://swflug.org/">SWFLUG</a>, 2007-04-10</p>
<p>More information can be found at:
<a href="/p/Cryptography_Linux_and_You">https://halcanary.org/p/Cryptography_Linux_and_You</a></p>
<p>Abstract:</p>
<blockquote>
<p>This 30 to 60 minute talk will deal with cryptography tools that commonly
come with modern Linux distributions. The "You" part of the title refers to
the fact that this will not be an overly technical talk and that these are
tools you can use in your daily life and work. Some of these tools you are
already using.</p>
<p>Prerequisites: You know that Linux is an operating system and you know that
many Linux users make use of the Command Line Interface to tell their
computer what to do. You know that cryptography is the science and art of
hiding a message so that only those who know a secret---called the key---can
read it. You might even know a little about the the history of cryptography
before about 1945, but we won't touch on ancient cryptography at all.</p>
</blockquote>
<p>Optional Activities:</p>
<blockquote>
<p>If several attendees bring laptops running Linux (or other flavor of Unix),
we could exchange GPG-encrypted emails as a demonstration. While we are at it
we could do an old-fashioned key-signing party.</p>
</blockquote>
<p>After the talk is given, I'll post the slides and the text here on this page.</p>
<hr />
<p><a href="/pub/2007-04-10-CLY/cryptography_linux_and_you_slides.pdf">Here are the slides from the talk.</a></p>
<p>Here is the prepared text:</p>
<script type="text/javascript">
const slide = (x) => {
    for (var i = 1; i <= 29; i++) {
        document.getElementById("slide-" + i).style.display = (x === i) ? "inline" : "none";
    }
    return true;
};
window.addEventListener("load", () => { slide(1); });
</script>

<div id="slide-1"><img src="/images/ev0001.png" alt="[slide]"></div>
<div><button onclick="slide(1)">SLIDE 1</button></div>

<p>The title of this talk is "Cryptography, Linux, and You". We will be dealing
with cryptography tools that commonly come with modern Linux distributions. The
"You" part of the title refers to (1) the fact that this will not be an overly
technical talk. It also refers to (2) the fact that these are tools you can use
in your daily life and work. Some of these tools you are already using.</p>
<p>Assumptions: You know that Linux is an operating system and you know that many
Linux users make use of the Command Line Interface to tell their computer what
to do. You know that cryptography is the science and art of hiding a message so
that only those who know a secret---called the key---can read it.</p>
<p>You know about the the history of cryptography: scytales (skitalys), the Caesar
cypher, Cryptoquips, Enigma machines and Bletchley Park, Shannon security, et
cetera. Because I won't touch on any of this history.</p>
<div id="slide-2"><img src="/images/ev0002.png" alt="[slide]"></div>
<div><button onclick="slide(2)">SLIDE 2</button></div>

<p>We are going to talk about three broad topics: hash functions, symmetric
cryptography, and asymmetric encryption. Strictly speaking, cryptographic hash
functions are not a form of cryptography, since cryptography literally means as
"secret writing". On the other hand, cryptographic hash functions are
incredibly useful for cryptographic applications.</p>
<p>Another thing we are going to touch on is digital signatures. These are not
"secret writing" either, but but they are (1) useful for securing encrypted
channels of communication, (2) make use of algorithms related to cryptography,
and (3) useful in themselves.</p>
<div id="slide-3"><img src="/images/ev0003.png" alt="[slide]"></div>
<div><button onclick="slide(3)">SLIDE 3</button></div>

<p>A checksum is a mathematical function that can be used to verify that an input
has not been accidentally changed.</p>
<p>For example, the 10 digit ISBN (International Standard Book Number) that every
book is identified with includes a checksum in the last digit.</p>
<p>CHECK_DIGIT = 11 - (∑(i=1, 9, (11 - i) · d[i]) modulo 11)</p>
<p>Hash functions are similar to checksums. For the sake of this talk, they are
the same thing. *Cryptographic* Hash Functions have the additional property
that it is relatively hard to make a change in the input to produce the same
output. Because of the danger of a brute force attack, useful cryptographic
hash functions have a large but finite range, larger than 2^128 elements.</p>
<p>Here's a list of four common cryptographic hash functions---md5, sha1, and sha2
(sha256 and sha512)---and the size of their range. Md5 and sha1 are broken,
which means that there is an attack on them that is faster than a brute force
attack. These attacks still take some processing power, so they are only "kind
of" broken. Any new application should be designed to use the sha2 family of
functions.</p>
<p>The NSA and NIST have announced that they plan on creating a new family of
cryptographic hash functions to replace sha2. It may be some years before this
happens.</p>
<div id="slide-4"><img src="/images/ev0004.png" alt="[slide]"></div>
<div><button onclick="slide(4)">SLIDE 4</button></div>

<p>Here's an example of how a you might make use of a hash function. These
functions take in a stream of bits---for example a file on a computer--- and
output a N-bit binary number. That number is usually represented as a
hexadecimal number. In this example, sha1 gives 40 digit hexadecimal number.
(Or more precisely a 40 hexadigit number) A hexadecimal digit is base 16 - 16
is 2^4, so each digit is 4 bits (half a byte). 4 bits per hexadigit times 40
digits gives 160 bits, which is what we expected form the information that I
gave you before!</p>
<p>Here I create two files test1 and test2. These two files differ by only one
character---a single period.</p>
<p>Aside: the echo command outputs the string "hello world". The "&gt;" symbol
redirects the output of echo into a file, in this case into the file test1</p>
<p>When I use the sha1sum program and tell it to give me a checksum on these two
files, it outputs two checksums, one for each file. Notice how different the
two sums are, even if the inputs were very much alike!</p>
<p>So I don't have to remember these checksums, I can store them in a file, which
I'll call "SHA1SUM.txt". Later, I'm going to come along and check to see that
these two files haven't accidentally changed. to do that I'll use "sha1sum -c".
The "-c" means check and reads input in a form identical to the output of
sha1sum. With "-c" I don't have to manually check the sums with my own
eyeballs.</p>
<div id="slide-5"><img src="/images/ev0005.png" alt="[slide]"></div>
<div><button onclick="slide(5)">SLIDE 5</button></div>

<p>Here I use some fancy commands to add a newline character to the end of the
file test2. Now it should give a different checksum because the file has
changed This time, "sha1sum -c" gave an error message!</p>
<div id="slide-6"><img src="/images/ev0006.png" alt="[slide]"></div>
<div><button onclick="slide(6)">SLIDE 6</button></div>

<p>Now we finally get to some real encryption!</p>
<div id="slide-7"><img src="/images/ev0007.png" alt="[slide]"></div>
<div><button onclick="slide(7)">SLIDE 7</button></div>

<p>For this example I want to encrypt these two files test1 and test2. The easiest
way to do that is to put them in a new directory by themselves than archive the
directory with the "tar -cz" command. This creates the compressed Tar archive
secretstuff.tgz. I then encrypt it with a program called GPG. I'm going to use
GPG in "symmetric mode" so I use the command "gpg -c" Here "-c" means
"symmetric". I think "-s" was already taken.</p>
<p>It asks for a passphrase twice---to make sure I entered it correctly.</p>
<p>This creates a file called secretstuff.tgz.gpg</p>
<div id="slide-8"><img src="/images/ev0008.png" alt="[slide]"></div>
<div><button onclick="slide(8)">SLIDE 8</button></div>

<p>To be secure, I'm going to use the shred program to securely delete the
original archive file. To recover the original file, I simply run the command
"gpg secretstuff.tgz.gpg". It asks for the passphrase and if I enter it
correctly, it will spit out the original file.</p>
<div id="slide-9"><img src="/images/ev0009.png" alt="[slide]"></div>
<div><button onclick="slide(9)">SLIDE 9</button></div>

<p>Why did I use the term "passphrase" and not "password". There is a subtle
difference. Passwords are short, while passphrases can be very long. If I knew
that your password was only eight characters long, I could try every eight
combination of eight letters - that would only take me a few days if I could
try one every microsecond. I could go much faster if your password is subject
to a dictionary attack. Say you are trying to attack my home server with a
brute-force attack against my ssh daemon. My sshd always closes the connection
after N incorrect passwords and waits about a second before it asks for another
password.</p>
<p>So passwords are great for situations where the system can control the number
of tries that can be allowed.</p>
<p>If an attacker gets a hold of the file secretstuff.tgz.gpg, that attacker could
try to crack that file as many times a second as he wants to. So you need to
pick a much harder to guess passphrase. Here's a table that lists the relative
"hardness to guess" of several passphrases. On this scale, a 1.0 is
approximately equals the security of a 128 bit number. If you guessed one
number every femptosecond (10^-15) it would take almost a million times the age
of the universe before you've exhausted all the 128 bit numbers out there. So
2^128 is considered a big number. On the other hand, cryptosystems with a key
64 bits long have been broken with brute force attacks (584542 per microsecond
for a year).</p>
<div id="slide-10"><img src="/images/ev0010.png" alt="[slide]"></div>
<div><button onclick="slide(10)">SLIDE 10</button></div>

<p>If I want a 128 bit random number, that's 16 bytes. Let's grab 16 byes out of
/dev/random --- Linux's random device. We'll use the head program to grab the
first 16 bytes it gives us. Then we'll that that and pipe it into the the
hexdump program so that we can get a human-readable format.
de4226f80c92e9de1030f4811b8b9a07---that's a good passphrase, but you'll never
remember it. We could also use the base64 program to make a shorter
human-readable passphrase.</p>
<p>There are a bunch of different ways to come up with perfectly random passwords.
Diceware is software that uses the random throw of dice to produce a
passphrase.</p>
<p>I choose to trust Linux's Random Device. The Linux Kernel watches its
environment---keyboard stokes, mouse movements, Ethernet traffic, et
cetera---and gathers randomness form the low bits of of the time when such
interrupts are received. Such inputs are considered very random. Since the
Linux kernel keeps track of how much randomness it has, /dev/random is
considered a true random number generator, and not a pseudorandom number
generator.</p>
<p>Microsoft's function CryptGenRandom() is not considered as secure as Linux's
/dev/random.</p>
<p>Just to see how /dev/random collects randomness from keystrokes, here's a
little program I wrote, timeinmicroseconds, that prints out the current time to
microsecond resolution. If I run it like this:</p>
<pre><code>while read -s -n 1 x ; do timeinmicroseconds ; done</code></pre>
<p>it will print out the time on every keystroke, until I hit Ctrl-C. Notice that
the current time in seconds is not very random, but the microseconds part of
the number is very random looking. Now you will think twice before doing this:</p>
<pre><code>srand(time(0));
int num = rand();</code></pre>
<p>which only looks at the current time in seconds. Here's a much better way of
getting a random number in C:</p>
<pre><code>FILE \*devrandom;
int num;
devrandom = fopen(&quot;/dev/random&quot;, &quot;rb&quot;);
fread(&amp;num, sizeof(num), 1, devrandom);
close(devrandom);</code></pre>
<div id="slide-11"><img src="/images/ev0011.png" alt="[slide]"></div>
<div><button onclick="slide(11)">SLIDE 11</button></div>

<p>Aespipe is a simple program that does one thing and does it well---it
implements the AES (Advanced Encryption Standard) block cypher. Aespipe can be
found in the Ubuntu universe or can be downloaded form this URL.</p>
<p>Aespipe is about twice as fast as GPG for symmetric encryption.</p>
<p>Aespipe either needs one 128-bit key or (in multi-key mode) 65 different
128-bit keys. It always gets these keys by applying a cryptographic hash
function to your passphrase(s). You can give it a passphrase in three different
ways. (1) You can type it in at the prompt (2) you can leave it in a file and
use the "-P file" option to read that file in (3) you can gpg-encrypt a file
and use the "-K" option to access that file.</p>
<div id="slide-12"><img src="/images/ev0012.png" alt="[slide]"></div>
<div><button onclick="slide(12)">SLIDE 12</button></div>

<p>We first create an excessively long passphrase (more entropy than we will need,
but why not?) and leave it in a ﬁle pass.txt</p>
<p>In the second step, we will use the pipeline to take the output of tar and
input it into aespipe. We redirect the final output into the file
secretstuff.tgz.aes.</p>
<p>In the next sequence, we add a passphrase to secure the keyfile!</p>
<p>When decrypting, use the "-d" option!</p>
<p>I recently backed up 58 GB of data through aespipe and onto an external drive.
The bottleneck seemed to be the aespipe program, but I was able to write about
5MB of data a second.</p>
<div id="slide-13"><img src="/images/ev0013.png" alt="[slide]"></div>
<div><button onclick="slide(13)">SLIDE 13</button></div>

<p>Public Key, or Asymmetric, Cryptography is relatively new. It was first made
public in the 1970s but was in use by governments for some years before that.
Before public-key cryptography, if N people want to communicate secretly among
themselves, they would need N*(N-1)/2 separate keys. Without Public Key
Crypto, Internet commerce would never have happened, among other things.</p>
<div id="slide-14"><img src="/images/ev0014.png" alt="[slide]"></div>
<div><button onclick="slide(14)">SLIDE 14</button></div>

<p>Public-key cryptography (PKC) uses different keys to encrypt and decrypt your
message! These two keys are mathematically related and must be generated at the
same time.</p>
<p>The public key is used to encrypt the message, while the private key is used to
decrypt it.</p>
<p>In 1991, Philip Zimmerman wrote PGP (pretty good privacy) and brought public
key crypto to the masses for the first time.</p>
<p>The algorithms that PGP make use of are not mathematically proven to be
unbreakable. At best, you can still bruteforce calculate the private key from
the public key, given an infinite amount of computing power or a quantum
computer with a few thousand qbits.</p>
<p>OpenPGP is a standard for PKC. GPG (Gnu Privacy Guard) is a F/OSS
implementation of the OpenPGP standard and is included in most distros. After
you have generated a key pair, you will want to publish the public key and keep
the private key safe. By default, GPG encrypts your private key with a
passphrase as an added layer of security in case some one gains access to your
computer.</p>
<p>In actuality, GPG or PGP encrypts your message with a symmetric cypher and then
encrypts the key to that cypher with PKE. This is considered faster and safer.</p>
<div id="slide-15"><img src="/images/ev0015.png" alt="[slide]"></div>
<div><button onclick="slide(15)">SLIDE 15</button></div>

<p>Let's start by generating a new keypairs. If you forget the command-line
options to GPG, use the command "man gpg" to get the full documentation. the
"--gen-key" option lets you create a new keypair.</p>
<p>Let's take the default options here. The key is going to have a copy of your
name and email address for easy searching online. When it's done reading from
the random device, it generates the key and drops the key in the ~/.gnupg/
directory. Each key has an ID---an 8 digit hexadecimal number, and a
fingerprint, a 40 digit hexadecimal number. The fingerprint is just a
cryptographic hash of the public key and can be used to verify that two copies
of a key are the same key. This is used to prevent a man-in-the middle attack.</p>
<p>You can get the fingerprint later by "gpg --fingerprint".</p>
<p>There are two ways of getting someone's key. They can give you a keyfile they
create with "gpg -a --export KEYID &gt; KEYID.txt". You could import it with "gpg
--import KEYID.txt".</p>
<p>Another option is to search a keyserver for a key, either over the web or using
GPG's "gpg --search-keys 'real name'" or "gpg --recv-keys KEYID". A key can be
uploaded via the web or "gpg --send-keys KEYID".</p>
<p>Once I've generated my own key pair and acquired and verified someone else's
public key, I can encrypt a file to send to them with "gpg --sign --encrypt
--recipient 'NAME' FILE".</p>
<p>If you receive a file, you can usually process it with "gpg FILE".</p>
<p>Ask for volunteers to send some files back and forth.</p>
<div id="slide-16"><img src="/images/ev0016.png" alt="[slide]"></div>
<div><button onclick="slide(16)">SLIDE 16</button></div>

<p>Digital Signatures are kind of like the opposite of Public Key Encryption. They
are used to verify that the signed file has not changed since they were signed
by someone who possessed the private key. Strictly speaking, you sign the
digest from a cryptographic hash function and not the file itself, but as long
as the hash function is secure, this is practically equivalent and much faster.</p>
<p>About ten years ago, a law was passed here in the United States which made
Digital Signatures legally equivalent to ordinary signatures. This law was
intended to facilitate Internet commerce.</p>
<p>The most well know algorithm for digital signatures is DSA (Digital Signature
Algorithm). I will show five applications of Digital Signatures.</p>
<div id="slide-17"><img src="/images/ev0017.png" alt="[slide]"></div>
<div><button onclick="slide(17)">SLIDE 17</button></div>

<p>The first application is signing a plain text document. This is used a lot for
a plain file on posted on a newsgroup or a web page where it is not feasible to
attach a second file with a signature file. Before email clients learned to
recognize attached signatures, this format was often used to sign emailed
messages as well.</p>
<p>Let's go through an example of signing something and verifying it. The commands
are "gpg --clearsign" and "gpg --verify".</p>
<div id="slide-18"><img src="/images/ev0018.png" alt="[slide]"></div>
<div><button onclick="slide(18)">SLIDE 18</button></div>

<p>The next way that this is often done is to clearsign a SHA1SUM file. This
became popular in situations where a person was already producing SHA1SUM files
and it was trivial to add a "gpg --clearsign" step to their routine. Then users
who were accustomed to checking files with "sha1sum -c" can continue with no
change to their routines and users who want to "gpg --verify" as well can do
that for added security.</p>
<p>Power users will insist on combining the two processes with a pipeline.</p>
<div id="slide-19"><img src="/images/ev0019.png" alt="[slide]"></div>
<div><button onclick="slide(19)">SLIDE 19</button></div>

<p>Here's a real-life example: Red Hat already was providing checksums for
downloaded files. It was trivial for them to begin signing those checksums.</p>
<div id="slide-20"><img src="/images/ev0020.png" alt="[slide]"></div>
<div><button onclick="slide(20)">SLIDE 20</button></div>

<p>Signing a random binary file. The "gpg --detach-sign" command creates a
separate signature. Your email client probably does a similar thing when it
GPG-signs an email and sends the signature as an attachment.</p>
<div id="slide-21"><img src="/images/ev0021.png" alt="[slide]"></div>
<div><button onclick="slide(21)">SLIDE 21</button></div>

<p>For example, if I use Evolution or Thunderbird, both popular GUI email clients
for Linux, then it is easy to enable encryption and digital signatures. In
Evolution, you can get to this screen from the Account Editor from Preferences.
Just enter the KEYID of the GPG key you want to use to sign mail and it just
works. You will have to provide your passphrase to unlock the private key each
time you use it.</p>
<p>Signed email should be ignored by clients unable to make use of those
signatures; it will serve as notice to everyone else that you use GPG!</p>
<div id="slide-22"><img src="/images/ev0022.png" alt="[slide]"></div>
<div><button onclick="slide(22)">SLIDE 22</button></div>

<p>Secure Sockets Layer (SSL) or TLS (Transport Layer Security) is a layer of
encryption that can be applied to any TCP/IP connection. When it is applied to
HTTP (the web's transfer protocol) the result is HTTPS, usually denoted by the
https:// URL scheme and the little lock icon in your browser window. SSL makes
use of PKE like something this: (I may be glossing over details)</p>
<ol type="1">
<li><p>Client (Web Browser) opens *clear* connection to server (Web Server).</p></li>
<li><p>Server responds by sending its public key.</p></li>
<li><p>Client looks at the key and sees that it has been digitally signed by a
Certificate Authority.</p></li>
<li><p>If the client ALREADY has a public key for that Certificate Authority, it
checks the signature. If not valid, it throws an error message.</p></li>
<li><p>If everything is on the up-and-up, the client generates a random session key
and asymmetrically encrypts it with the server's key. It then responds to the
server with this encrypted message.</p></li>
<li><p>The server uses its private key to decrypt the session key. From here on
out, both the client and the server will encrypt everything they send each
other with this session key.</p></li>
</ol>
<p>Before any of this can happen, the following must happen behind the scene:</p>
<p>A) The server must generate a keypair.</p>
<p>B) The server must give a CA money and prove to the CA that they are who they
say they are in exchange for a signature on the public key.</p>
<p>C) That CA must convince the makers of all web browsers to include the CA's
public key with the web browser.</p>
<div id="slide-23"><img src="/images/ev0023.png" alt="[slide]"></div>
<div><button onclick="slide(23)">SLIDE 23</button></div>

<p>You can go to this page in Mozilla Firefox and get a list of all the CA's that
it trusts.</p>
<div id="slide-24"><img src="/images/ev0024.png" alt="[slide]"></div>
<div><button onclick="slide(24)">SLIDE 24</button></div>

<p>Here's a screenshot from the "Page Info" box when I visit my bank's website.
Bank of America paid VeriSign to sign its key.</p>
<p>Why go through all this rigmarole? To prevent a Man-in-the-Middle attack. If a
malicious person intercepted my original connection to the bank and gave me a
his own key, he could turn around and echo everything I said to the bank using
the bank's own key.</p>
<p>Draw a picture.</p>
<div id="slide-25"><img src="/images/ev0025.png" alt="[slide]"></div>
<div><button onclick="slide(25)">SLIDE 25</button></div>

<p>SSH (Secure Shell) was originally designed to replace rsh and telnet, programs
which allowed remote logins to servers *without* any encryption. Even the
passwords were sent in cleartext. On an ethernet, it was ridiculously easy to
use a program called Ethereal to snoop on telnet sessions and steal passwords.</p>
<p>The only two versions of SSH I use these days are OpenSSH, which comes with
most Linux distributions, and Putty, which is available in a native Windows
version.</p>
<p>Like SSL, the session key for your SSH connection is encrypted with the
server's public key. When installing the SSH daemon, you generate a keypair.</p>
<p>In order to prevent a man-in-the-middle attack, you'll need to manually check
the fingerprint on the server's key. You'll only need to do this the first time
your client connects to a server or if a server gets a new keypair.</p>
<p>To find the fingerprints on a server, you can use the command "ssh-keygen -lf".
The public keys are kept in the files /etc/ssh/ssh_host_*key.pub</p>
<p>First and foremost, SSH is used to remotely log into a command-line environment
on a remote machine. For those who do a lot of work on the command line
already, the utility of this is obvious. For example, I have used remote logins
to:</p>
<ol type="1">
<li><p>log into a web server and make changes to the files there directly---without
the need to make local copies and ftp them over to the server.</p></li>
<li><p>Log into a Linux machine that I was using as a router so I can modify the
firewall rules using iptables.</p></li>
<li><p>Remotely long into a workstation to run mathematical or physical simulations
that might take a lot of computational power and time to run.</p></li>
<li><p>Log into a email server and run Mutt or Pine to locally read and respond to
my email.</p></li>
<li><p>Use "wall" to talk to other users on the same machine.</p></li>
</ol>
<p>But that's not all!</p>
<div id="slide-26"><img src="/images/ev0026.png" alt="[slide]"></div>
<div><button onclick="slide(26)">SLIDE 26</button></div>

<p>SSH can be used to copy files or even whole directories with the "scp" or
"sftp" commands. I am especially fond of the scp command, which has beautiful
syntax, stolen from the old "rcp" command. In my opinion, scp has more of the
Unix Philosophy than sftp does.</p>
<p>In the rsync example, we use the rsync command to manage the actual copying of
files, but we *connect* to the ssh daemon and don't need to run a rsync
daemon. Rsync is smart enough to minimize network usage at the expense of
processor time.</p>
<p>You can also run a rsync daemon on the other end, without the need for ssh.
This is often used for anonymous, download-only rsync.</p>
<p>Port forwarding. In the first example, we forward the X11 protocol. Now
programs that run on the remote machine running a ssh server can act as X11
clients for the X11 server that runs on the local machine running a ssh client.
If you've got Linux on both ends, you probably already have a X11 server on
your local machine---it's what your GUI (graphical user interface) is built on!</p>
<p>Example: run xclock or xterm.</p>
<p>Dynamic Port forwarding. In the second example, we dynamically forward
localhost port 12345 to be a SOCKS port. To make use of it, we'll have to
configure an application to make use of this port. But first let's draw a
picture:</p>
<div id="slide-27"><img src="/images/ev0027.png" alt="[slide]"></div>
<div><button onclick="slide(27)">SLIDE 27</button></div>

<p>Here is a graphic which shows the relevant parts of a hypothetical situation I
find myself in all the time. I'm at a coffee shop and have my laptop with me. I
want to browse the web off the free WiFi someone has provided, but since it is
not encrypted, anyone could listen in. Worse, I know the hotspot provider could
be monitoring my traffic. Even if I use SSL, which is not always possible,
he'll know what web sites I visit. Strictly speaking, you always have this sort
of problem with any connection to the Internet, but with your ISP, you pay them
money to give you Internet service. It is in their best intre$t to respect your
privacy.</p>
<p>Beforehand, I have</p>
<ol type="1">
<li><p>Figured out how to open port 22 (or other port) on my DSL or cable modem and
how to forward that port to my Linux workstation on my home network.</p></li>
<li><p>Run sshd on my workstation, opened port 22 on my iptables firewall, and left
my computer running while I'm out.</p></li>
<li><p>Gone to dyndns.org and set up a free account so example.dyndns.org now
points at my home machine. I run the ddclient daemon that periodically updates
the dyndns dns server on my current DHCPed IP address.</p></li>
<li><p>Have a copy of my home machine's SSH key fingerprint either with me printed
on a piece of paper, on a computer file, or in my laptop's ~/.ssh/known_hosts
file.</p></li>
</ol>
<p>Now all I need to do is "ssh -D 12345 example.dyndns.org". The hypothetical
malevolent ISP *will* know that you have opened a ssh connection to
example.dyndns.org, and will see a bunch of encrypted information going back
and forth, but if you trust the SSH encryption, then there is no way for him to
know anything beyond how much information is being passed in each direction.
(Remember that I will completely fail to mention any sort of *deniable*
cryptography today.)</p>
<p>We will want to convince my web browser to send any outgoing packets through
the ssh tunnel to my workstation, then out to the Internet at large,
unencrypted.</p>
<div id="slide-28"><img src="/images/ev0028.png" alt="[slide]"></div>
<div><button onclick="slide(28)">SLIDE 28</button></div>

<p>I need to tell my web browser to use the SOCKS proxy at localhost:12345. Here's
how I do it in Firefox 2.0.0.x. I use the "MM3 ProxySwitch" Add-On to quickly
switch back and forth between proxied and unproxied modes. My configuration
file looks this:</p>
<pre><code>\[socksproxy
  socks=127.0.0.1:12345
  noProxy=127.0.0.1
\]</code></pre>
<p>And that's all there is. I'd like to bust out Ethereal to show how http traffic
is encrypted now, but that's out of the scope of this talk.</p>
<div id="slide-29"><img src="/images/ev0029.png" alt="[slide]"></div>
<div><button onclick="slide(29)">SLIDE 29</button></div>

<p>Conclusions: There's a lot more to this subject than just picking the right algorithm!</p>
<hr />
<div class="rightside">

<p>file modification time: 2007-04-11 18:22:13</p>
</div>

</div>
</body>
</html>
